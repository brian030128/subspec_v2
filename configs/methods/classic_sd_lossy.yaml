# Classic tree-SD with lossy verification
method: classic_sd

llm_path: meta-llama/Llama-3.1-8B-Instruct
draft_model_path: meta-llama/Llama-3.2-1B-Instruct

recipe: null

max_length: 2048
cache_implementation: static
warmup_iter: 1
compile_mode: max-autotune

# Target sampling settings (defaults)
do_sample: false
temperature: 0

generator_profiling: true

generator_kwargs:
  prefill_chunk_size: 4096
  verify_method: lossy
  verify_kwargs:
    # Probability threshold on target distribution for accepting a non-matching draft child.
    # Lossy accept is allowed only when probs[parent, draft_token] >= threshold.
    threshold: 0.3
    # Require at least this many future locally-correct nodes (lookahead).
    window_size: 6

draft_params:
  temperature: 1.0
  max_depth: 8
  topk_len: 16
